 <!DOCTYPE html>
{% extends "base.html" %}
{% import "navbar.html" as nav with context %}
{% block navbar %}
    {{ nav }}
{% endblock navbar %}

{% block content %}
<div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th>{{ _('Nr.') }}</th>
                    <th>{{ _('Type') }}</th>
                    <th>{{ _('Plugin') }}</th>
                    <th>{{ _('Classname') }}</th>
                    <th>{{ _('Instanz') }}</th>
                    <th>{{ _('Version') }}</th>
                    <th>{{ _('Mehrere Instanzen m√∂glich') }}</th>
                </tr>
            </thead>
            <tbody>
                {% for p in plugins  %}
                <tr id="{{ loop.index }}_click" style="cursor: pointer;">
                    <td width="30px">{{ loop.index }}</td>
                    <td width="30px">{% if p.smartplugin %}SmartPlugin{%else%}Classic{%endif%}
                    <td width="200px">{{ p.classpath }}</td>
                    <td width="160px">{{ p.classname }}</td>
                    {% if p.smartplugin %}
                        <td width="200px">
                        {% if p.instancename %}{{ p.instancename }}{%else%}default{%endif%}
                        </td>
                        <td width="150px">{{ p.version }}</td>
                        <td width="160px">{% if p.multiinstance %}{{ _('Ja') }}{%else%}{{ _('Nein') }}{%endif%}</td>
                    {% else %}
                        <td>-</td>
                        <td>-</td>
                        <td>-</td>
                    {%endif%}
                </tr>
                <tr id="{{ loop.index }}_additional" style="display: none; cursor: pointer;">
                    <td colspan="7">
                        <div class="panel panel-default">
                            <div class="panel-heading">{{ _('Plugin spezifische Attribute') }}:</div>
                            <div class="panel-body">
                                {% if p.attributes|length > 2 %}
                                {% for key, value in p.attributes.items() %}
                                    {% if key not in ['class_path', 'class_name'] %}
                                    <strong>{{ key }}:</strong> {{ value }}<br/>
                                    {%endif%}
                                {% endfor %}
                                {% else %}
                                -
                                {%endif%}
                            </div>
                        </div>
                    </td>
                </tr>
                <script>
                $(document).on('click', 'tr', function(event){
                    if (event.target.closest('tr').id == '{{ loop.index }}_click') {
                        $('#'+event.target.closest('tr').id.replace('click', 'additional')).toggle();
                    } else if (event.target.closest('tr').id == '{{ loop.index }}_additional') {
                        $('#'+event.target.closest('tr').id).toggle();
                    }
                });
                </script>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}
